import React from 'react';
import './configuration.css' 
import {Logs} from './logs/logs.jsx'
import 'bootstrap/dist/css/bootstrap.min.css';
import Container from 'react-bootstrap/Container';
import Row from 'react-bootstrap/Row';
import Col from 'react-bootstrap/Col';
import Button from 'react-bootstrap/Button'

var axios = require('axios')
export class Configuration extends React.Component{
    constructor(props){
        super(props)
        this.state = {scan: false, quick: false, text: "", addresses: []}
        this.onClick = this.onClick.bind(this)
        this.onChange = this.onChange.bind(this)
        this.quick = false;
        this.checkScan = this.checkScan.bind(this)
        this.getAddresses = this.getAddresses.bind(this)
    }
    checkScan(){
        var _this = this
        axios.get('/api')
          .then(function (response) {
            if(response.data.scan == true){
                _this.setState({scan: true})
            }
            if(response.data.quick == true){
                _this.setState({quick: true})
            }
            _this.setState({text: response.data.text})
            })
          .catch(function (error) {
            console.log(error);
          });
    }
    getAddresses(){
        var _this = this
        axios.get('/getAssets')
        .then(function (response) {
            console.log(response)
            _this.setState({addresses: response.data.assets})
          })
        .catch(function (error) {
          console.log(error);
        });
        this.checkScan()

    }
    onClick(){
        var _this = this
        this.setState({scan: true}) 
        axios.post('/api?scan=true' + '&quick='+_this.state.quick + "&ips=" + _this.state.addreses)
          .then(function (response) {
            })
          .catch(function (error) {
            console.log(error);
          });
          this.checkScan()
    }
    onChange(){
        if(this.state.quick){
            this.setState({quick: false})
        }else{
            this.setState({quick: true})
        }    }
    componentDidMount(){
        this.getAddresses()
        this.checkScan()

    }
    render(){
        return(
            <div>
                <Container>
                    <Row>
                        <Col>
                            <ListBox/>
                            <Button variant="info">Test</Button>
                        </Col>
                        <Col className="logs">
                            <Logs type="metasploit"/>
                            <Logs/>
                        </Col>
                    </Row>
                </Container>
            </div>
        )
    }
}